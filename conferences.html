<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Omicentra | Conferences</title>
  <meta name="description" content="A curated list of bioinformatics and omics conferences with simple filtering." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#ffffff;
      --text:#111827;
      --muted:#374151;
      --muted2:#4b5563;

      --accent1:#7c3aed;
      --accent2:#06b6d4;

      --border:#e5e7eb;
      --soft:#f6f7fb;

      --focus:#0ea5e9;
      --focusRing: rgba(14,165,233,.25);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    html{height:100%}
    body{
      min-height:100%;
      margin:0;
      font-family: Montserrat, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 520px at 15% 10%, rgba(124,58,237,.10), transparent 60%),
        radial-gradient(760px 460px at 85% 18%, rgba(6,182,212,.10), transparent 55%),
        linear-gradient(180deg, #ffffff, #fbfcff);
      line-height:1.5;
    }

    .skip-link{
      position:absolute;
      left:12px; top:12px;
      transform: translateY(-150%);
      background:#fff;
      color:var(--text);
      padding:12px 14px;
      border-radius:12px;
      border:2px solid var(--focus);
      text-decoration:none;
      z-index:1000;
    }
    .skip-link:focus{
      transform: translateY(0);
      box-shadow: 0 0 0 6px var(--focusRing);
    }

    :focus{outline:none}
    :focus-visible{
      outline:2px solid var(--focus);
      outline-offset:3px;
      box-shadow: 0 0 0 6px var(--focusRing);
      border-radius: 12px;
    }

    .container{
      max-width: 1100px;
      margin: 0 auto;
      padding: 56px 24px 28px;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      flex-wrap:wrap;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      text-decoration:none;
      color:inherit;
    }

    .logo{
      width:44px; height:44px;
      border-radius:14px;
      border:1px solid var(--border);
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.55)),
        linear-gradient(135deg, rgba(124,58,237,.16), rgba(6,182,212,.12));
      display:grid;
      place-items:center;
      font-weight:800;
      color:#111827;
      opacity:.9;
      flex: 0 0 auto;
    }

    .brand-text strong{
      display:block;
      font-weight:800;
      letter-spacing:.2px;
    }
    .brand-text small{
      display:block;
      color:var(--muted2);
      font-size:12px;
      margin-top:2px;
    }

    .topnav{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    .navlink{
      display:inline-flex;
      min-height:44px;
      align-items:center;
      padding: 10px 12px;
      border-radius: 14px;
      border:1px solid var(--border);
      background:#fff;
      text-decoration:none;
      color:var(--muted);
      font-weight:800;
      letter-spacing:.2px;
    }
    .navlink:hover{
      background: var(--soft);
      color: var(--text);
      border-color: rgba(17,24,39,.18);
    }
    .navlink[aria-current="page"]{
      border-color: rgba(124,58,237,.35);
      background: linear-gradient(135deg, rgba(124,58,237,.14), rgba(6,182,212,.12));
      color: var(--text);
    }

    h1{
      font-size: clamp(34px, 4vw, 46px);
      line-height:1.1;
      margin: 26px 0 10px;
      letter-spacing:-0.5px;
    }

    .lead{
      color: var(--muted);
      max-width: 72ch;
      margin: 0 0 14px;
    }

    .status{
      margin: 10px 0 0;
      color: var(--muted2);
      font-size: 13px;
      min-height: 20px;
    }

    .filters{
      margin-top: 18px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.85);
      border-radius: var(--radius);
      padding: 14px;
      display:grid;
      grid-template-columns: 1.4fr 1fr 1fr 1fr auto;
      gap:12px;
      align-items:end;
    }

    @media (max-width: 980px){
      .filters{grid-template-columns: 1fr 1fr; align-items:stretch;}
    }
    @media (max-width: 560px){
      .filters{grid-template-columns: 1fr;}
    }

    label{
      display:block;
      font-weight:800;
      font-size: 12px;
      color: var(--muted2);
      margin-bottom: 6px;
    }

    input[type="search"], select{
      width:100%;
      min-height:44px;
      border-radius: 14px;
      border:1px solid var(--border);
      background:#fff;
      padding: 10px 12px;
      font: inherit;
      color: var(--text);
    }

    .btn{
      display:inline-flex;
      min-height:44px;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 10px 14px;
      border-radius: 14px;
      border:1px solid var(--border);
      background: var(--soft);
      color: var(--muted);
      font-weight:900;
      letter-spacing:.2px;
      cursor:pointer;
      user-select:none;
    }
    .btn:hover{
      background: rgba(17,24,39,.03);
      border-color: rgba(17,24,39,.18);
      color: var(--text);
    }

    /* View switch (segmented control) */
    .viewbar{
      margin-top: 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    .seg{
      display:inline-flex;
      border:1px solid var(--border);
      border-radius: 14px;
      overflow:hidden;
      background:#fff;
    }

    .seg button{
      min-height:44px;
      padding: 10px 14px;
      border:0;
      background:transparent;
      color: var(--muted);
      font-weight:900;
      letter-spacing:.2px;
      cursor:pointer;
    }

    .seg button[aria-pressed="true"]{
      background: linear-gradient(135deg, rgba(124,58,237,.14), rgba(6,182,212,.12));
      color: var(--text);
    }

    .seg button:not([aria-pressed="true"]):hover{
      background: var(--soft);
      color: var(--text);
    }

    .grid{
      margin-top: 14px;
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:12px;
    }
    @media (max-width: 980px){ .grid{grid-template-columns: repeat(2, minmax(0,1fr));} }
    @media (max-width: 620px){ .grid{grid-template-columns: 1fr;} }

    .card{
      border:1px solid var(--border);
      background: rgba(255,255,255,.92);
      border-radius: var(--radius);
      padding: 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .card h2{
      font-size: 16px;
      margin:0;
      line-height:1.25;
      letter-spacing:-0.2px;
    }

    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      color: var(--muted);
      font-size: 13px;
    }

    .chip{
      display:inline-flex;
      align-items:center;
      padding: 6px 10px;
      border-radius:999px;
      border:1px solid rgba(17,24,39,.12);
      background: rgba(17,24,39,.02);
      font-size: 12px;
      color: var(--muted);
      font-weight:800;
      text-transform: none;
    }

    .cta{
      margin-top:auto;
      display:inline-flex;
      min-height:44px;
      align-items:center;
      justify-content:center;
      border-radius: 14px;
      border:1px solid rgba(124,58,237,.30);
      background: linear-gradient(135deg, rgba(124,58,237,.14), rgba(6,182,212,.12));
      text-decoration:none;
      color: var(--text);
      font-weight:900;
      letter-spacing:.2px;
    }

    /* Table view */
    .tablewrap{
      margin-top: 14px;
      border:1px solid var(--border);
      border-radius: var(--radius);
      overflow:auto;
      background: rgba(255,255,255,.92);
    }

    table{
      width:100%;
      border-collapse: collapse;
      min-width: 860px; /* enables horizontal scroll on small screens */
    }

    thead th{
      position: sticky;
      top: 0;
      background: rgba(255,255,255,.98);
      border-bottom: 1px solid var(--border);
      text-align:left;
      font-size: 12px;
      letter-spacing:.2px;
      color: var(--muted2);
      padding: 12px 12px;
      font-weight: 900;
      z-index:1;
    }

    tbody td{
      border-bottom: 1px solid rgba(17,24,39,.08);
      padding: 12px 12px;
      vertical-align: top;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.4;
    }

    tbody tr:hover{
      background: rgba(17,24,39,.02);
    }

    .tname{
      color: var(--text);
      font-weight: 900;
    }

    .tlink a{
      display:inline-flex;
      min-height:44px;
      align-items:center;
      padding: 0 12px;
      border-radius: 12px;
      border:1px solid rgba(124,58,237,.30);
      background: linear-gradient(135deg, rgba(124,58,237,.10), rgba(6,182,212,.10));
      text-decoration:none;
      color: var(--text);
      font-weight: 900;
      letter-spacing:.2px;
      white-space:nowrap;
    }

    footer{
      margin-top: 28px;
      padding: 18px 0 8px;
      color: var(--muted2);
      font-size: 12px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      border-top: 1px solid var(--border);
    }

    .sr-only{
      position:absolute;
      width:1px;height:1px;
      padding:0;margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }

    [hidden]{display:none !important;}
  </style>
</head>

<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <div class="container">
    <header aria-label="Site header">
      <a class="brand" href="/index.html" aria-label="Go to Omicentra homepage">
        <div class="logo" aria-hidden="true">O</div>
        <div class="brand-text">
          <strong>Omicentra</strong>
          <small>Spotlight on bioinformatics</small>
        </div>
      </a>

      <nav class="topnav" aria-label="Primary navigation">
        <a class="navlink" href="/index.html">Home</a>
        <a class="navlink" href="/conferences.html" aria-current="page">Conferences</a>
      </nav>
    </header>

    <main id="main" tabindex="-1">
      <h1>Conferences</h1>
      <p class="lead">A curated list of bioinformatics and omics events.</p>

      <section class="filters" aria-label="Conference filters">
        <div>
          <label for="q">Search</label>
          <input id="q" type="search" placeholder="Search by name or keyword" autocomplete="off" />
        </div>

        <div>
          <label for="region">Region</label>
          <select id="region">
            <option value="all">All</option>
          </select>
        </div>

        <div>
          <label for="topic">Topic</label>
          <select id="topic">
            <option value="all">All</option>
          </select>
        </div>

        <div>
          <label for="format">Format</label>
          <select id="format">
            <option value="all">All</option>
          </select>
        </div>

        <div>
          <label class="sr-only" for="reset">Reset filters</label>
          <button id="reset" class="btn" type="button">Reset</button>
        </div>
      </section>

      <div class="viewbar" aria-label="View options">
        <div class="seg" role="group" aria-label="View toggle">
          <button id="viewCards" type="button" aria-pressed="true">Cards</button>
          <button id="viewTable" type="button" aria-pressed="false">Table</button>
        </div>
        <p class="status" id="status" role="status" aria-live="polite"></p>
      </div>

      <!-- Cards view -->
      <section class="grid" id="grid" aria-label="Conference cards"></section>

      <!-- Table view -->
      <section class="tablewrap" id="tablewrap" aria-label="Conference table" hidden>
        <table>
          <thead>
            <tr>
              <th scope="col">Conference</th>
              <th scope="col">Dates</th>
              <th scope="col">Location</th>
              <th scope="col">Region</th>
              <th scope="col">Format</th>
              <th scope="col">Topics</th>
              <th scope="col">Deadline</th>
              <th scope="col">Website</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </section>
    </main>

    <footer aria-label="Footer">
      <div>© <span id="year" aria-label="Current year"></span> Omicentra</div>
      <div><a href="/index.html">Home</a></div>
    </footer>
  </div>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    const DATA_URL = "/data/conferences.json";

    const q = document.getElementById("q");
    const regionSel = document.getElementById("region");
    const topicSel = document.getElementById("topic");
    const formatSel = document.getElementById("format");
    const resetBtn = document.getElementById("reset");

    const viewCardsBtn = document.getElementById("viewCards");
    const viewTableBtn = document.getElementById("viewTable");

    const grid = document.getElementById("grid");
    const tableWrap = document.getElementById("tablewrap");
    const tbody = document.getElementById("tbody");
    const statusEl = document.getElementById("status");

    let conferences = [];
    let currentView = "cards"; // "cards" | "table"

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#39;");
    }

    function formatDate(iso){
      if (!iso) return "TBA";
      const d = new Date(iso + "T00:00:00");
      if (Number.isNaN(d.getTime())) return "TBA";
      return d.toLocaleDateString(undefined, { year:"numeric", month:"short", day:"2-digit" });
    }

    function toKey(s){
      return String(s || "").trim().toLowerCase().replace(/\s+/g, "-");
    }

    function uniqSorted(arr){
      return Array.from(new Set(arr)).sort((a,b)=>a.localeCompare(b));
    }

    function normalizeRegion(v){
      const x = String(v || "").trim();
      if (!x) return "Unknown";
      if (x.toLowerCase() === "usa") return "USA";
      return x;
    }

    function normalizeFormat(v){
      const x = String(v || "").trim().toLowerCase();
      if (!x) return "unknown";
      return x;
    }

    function topicList(c){
      const t = Array.isArray(c.topic) ? c.topic : (c.topic ? [c.topic] : []);
      return t.map(x => String(x)).filter(Boolean);
    }

    function buildSelect(selectEl, values){
      const current = selectEl.value || "all";
      selectEl.innerHTML = '<option value="all">All</option>';
      for (const v of values){
        const opt = document.createElement("option");
        opt.value = toKey(v);
        opt.textContent = v;
        selectEl.appendChild(opt);
      }
      if ([...selectEl.options].some(o => o.value === current)) selectEl.value = current;
    }

    function conferenceLocation(c){
      return (c.location_city && c.location_country)
        ? `${c.location_city}, ${c.location_country}`
        : (c.location_country || c.location_city || "TBA");
    }

    function conferenceDateRange(c){
      return (c.start_date || c.end_date)
        ? `${formatDate(c.start_date)} – ${formatDate(c.end_date)}`
        : "TBA";
    }

    function conferenceDeadline(c){
      return c.submission_deadline ? formatDate(c.submission_deadline) : "—";
    }

    function renderCard(c){
      const name = c.name || "Untitled";
      const website = c.website || "#";
      const region = normalizeRegion(c.region);
      const format = normalizeFormat(c.format);
      const topics = topicList(c);

      const chips = [
        region,
        format.toUpperCase(),
        ...topics.slice(0, 2)
      ];

      const chipHtml = chips.map(x => `<span class="chip">${escapeHtml(x)}</span>`).join("");

      const article = document.createElement("article");
      article.className = "card";
      article.dataset.title = String(name).toLowerCase();
      article.dataset.region = toKey(region);
      article.dataset.format = toKey(format);
      article.dataset.topic = topics.map(t => toKey(t)).join("|");

      article.innerHTML = `
        <h2>${escapeHtml(name)}</h2>
        <div class="meta">
          ${chipHtml}
          <span class="chip">${escapeHtml(conferenceLocation(c))}</span>
          <span class="chip">${escapeHtml(conferenceDateRange(c))}</span>
          ${c.submission_deadline ? `<span class="chip">Deadline: ${escapeHtml(formatDate(c.submission_deadline))}</span>` : ""}
        </div>
        <a class="cta" href="${escapeHtml(website)}" target="_blank" rel="noopener noreferrer"
           aria-label="Open conference website: ${escapeHtml(name)}">
          Conference website
        </a>
      `;
      return article;
    }

    function renderRow(c){
      const name = c.name || "Untitled";
      const website = c.website || "#";
      const region = normalizeRegion(c.region);
      const format = normalizeFormat(c.format);
      const topics = topicList(c);

      const tr = document.createElement("tr");
      tr.dataset.title = String(name).toLowerCase();
      tr.dataset.region = toKey(region);
      tr.dataset.format = toKey(format);
      tr.dataset.topic = topics.map(t => toKey(t)).join("|");

      tr.innerHTML = `
        <td class="tname">${escapeHtml(name)}</td>
        <td>${escapeHtml(conferenceDateRange(c))}</td>
        <td>${escapeHtml(conferenceLocation(c))}</td>
        <td>${escapeHtml(region)}</td>
        <td>${escapeHtml(format.toUpperCase())}</td>
        <td>${escapeHtml(topics.join(", ") || "—")}</td>
        <td>${escapeHtml(conferenceDeadline(c))}</td>
        <td class="tlink">
          <a href="${escapeHtml(website)}" target="_blank" rel="noopener noreferrer"
             aria-label="Open conference website: ${escapeHtml(name)}">
            Website
          </a>
        </td>
      `;
      return tr;
    }

    function nodesForFiltering(){
      return currentView === "cards"
        ? Array.from(grid.children)
        : Array.from(tbody.children);
    }

    function applyFilters(){
      const qv = q.value.trim().toLowerCase();
      const rv = regionSel.value;
      const tv = topicSel.value;
      const fv = formatSel.value;

      let shown = 0;

      for (const node of nodesForFiltering()){
        const title = node.dataset.title || "";
        const r = node.dataset.region || "all";
        const f = node.dataset.format || "all";
        const topics = (node.dataset.topic || "").split("|").filter(Boolean);

        const matchQ = qv === "" || title.includes(qv);
        const matchR = rv === "all" || r === rv;
        const matchF = fv === "all" || f === fv;
        const matchT = tv === "all" || topics.includes(tv);

        const ok = matchQ && matchR && matchT && matchF;
        node.style.display = ok ? "" : "none";
        if (ok) shown++;
      }

      statusEl.textContent = `${shown} conference${shown === 1 ? "" : "s"} shown`;
    }

    function setView(view){
      currentView = view;
      const isCards = view === "cards";

      viewCardsBtn.setAttribute("aria-pressed", String(isCards));
      viewTableBtn.setAttribute("aria-pressed", String(!isCards));

      grid.hidden = !isCards;
      tableWrap.hidden = isCards;

      // Re-apply filters on the newly visible view
      applyFilters();

      // Persist preference
      try { localStorage.setItem("omicentra_view", view); } catch {}
    }

    async function loadData(){
      statusEl.textContent = "Loading conferences…";

      const res = await fetch(DATA_URL, { cache: "no-store" });
      if (!res.ok) throw new Error(`Failed to load ${DATA_URL} (${res.status})`);

      const data = await res.json();
      if (!Array.isArray(data)) throw new Error("Invalid JSON: expected an array");

      conferences = data;

      const regions = uniqSorted(conferences.map(c => normalizeRegion(c.region)).filter(Boolean));
      const formats = uniqSorted(conferences.map(c => normalizeFormat(c.format)).filter(Boolean).map(f => f.toUpperCase()));
      const topics = uniqSorted(conferences.flatMap(c => topicList(c)).filter(Boolean));

      buildSelect(regionSel, regions);
      buildSelect(topicSel, topics);

      // Format select: show uppercase labels but store lowercase keys
      formatSel.innerHTML = '<option value="all">All</option>';
      for (const f of formats){
        const opt = document.createElement("option");
        opt.value = toKey(String(f).toLowerCase());
        opt.textContent = f;
        formatSel.appendChild(opt);
      }

      // Render both views once
      grid.innerHTML = "";
      tbody.innerHTML = "";
      for (const c of conferences){
        grid.appendChild(renderCard(c));
        tbody.appendChild(renderRow(c));
      }

      // Restore preferred view
      let saved = "cards";
      try { saved = localStorage.getItem("omicentra_view") || "cards"; } catch {}
      setView(saved === "table" ? "table" : "cards");
    }

    q.addEventListener("input", applyFilters);
    regionSel.addEventListener("change", applyFilters);
    topicSel.addEventListener("change", applyFilters);
    formatSel.addEventListener("change", applyFilters);

    resetBtn.addEventListener("click", () => {
      q.value = "";
      regionSel.value = "all";
      topicSel.value = "all";
      formatSel.value = "all";
      applyFilters();
      q.focus();
    });

    viewCardsBtn.addEventListener("click", () => setView("cards"));
    viewTableBtn.addEventListener("click", () => setView("table"));

    loadData().catch(err => {
      console.error(err);
      statusEl.textContent = "Failed to load conferences.";
      grid.innerHTML = "";
      tbody.innerHTML = "";
    });
  </script>
</body>
</html>


